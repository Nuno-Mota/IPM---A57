


<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        @-webkit-keyframes bluePulse {
            from {
                background-color: #007ffe;
                -webkit-box-shadow: 0 0 0 #333;
            }

            to {
                background-color: #003f7f;
                -webkit-box-shadow: 0 0 18px #003f7f;
            }
        }

        @-webkit-keyframes grayPulse {
            from {
                background-color: #d3d3d3;
                -webkit-box-shadow: 0 0 0 #333;
            }

            to {
                background-color: #d3d3d3;
                -webkit-box-shadow: 0 0 18px #d3d3d3;
            }
        }

        h1 {
            background-color: #007ffe;
            color: white;
            text-align: center;
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        }

        #textInput {
            text-align: center;
            font-family: verdana;
            font-weight: bold;
            margin-right: 10px;
        }

        #incial {
            margin-top: 20px;
            text-align: center;
            font-size: 16px;
        }

        .tax {
            opacity: 0;
        }


        .button {
            display: block;
            width: 115px;
            height: 25px;
            background: #007ffe;
            text-align: center;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            font-size: 18px;
            display: inline-block;
            padding-left: 20px;
            margin-left: 20px;
        }

        a.button:hover {
            background-color: #003f7f;
            -webkit-animation-name: bluePulse;
            -webkit-animation-duration: 0.5s;
            -webkit-animation-iteration-count: 1;
            -webkit-box-shadow: 0 0 18px #003f7f;
        }

        input.button:hover {
            background-color: #d3d3d3;
            -webkit-animation-name: grayPulse;
            -webkit-animation-duration: 1s;
            -webkit-animation-iteration-count: infinite;
            -webkit-box-shadow: 0 0 18px #d3d3d3;
        }

        #butao {
            width: 130px;
            height: 50px;
            background: #d3d3d3;
            padding: 7px;
            text-align: center;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            margin-left: auto;
            margin-right: auto;
            font-size: 18px;
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        }

        #butaotaxi {
            width: 130px;
            height: 50px;
            background: #d3d3d3;
            padding: 7px;
            text-align: center;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            margin-left: auto;
            margin-right: auto;
            font-size: 18px;
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
            white-space: normal;
        }

        #tutorial {
            padding-left: 0;
            padding-right: 0;
            margin-left: auto;
            margin-right: auto;
            display: block;
        }

        #textbutt {
            padding-left: 0;
            padding-right: 0;
            display: block;
        }

        #backToMainMenu {
            /*TODO: falta por a seta num sitio fixo. Quando o icon do taxi aparece, ela anda para baixo*/
            position:relative;
            top: 50px;

        }

        #taxi {
            margin-top: 7px;
        }

        .pulse2 {
            -webkit-animation: pulse2 1s linear infinite;
            -moz-animation: pulse2 1s linear infinite;
            -ms-animation: pulse2 1s linear infinite;
            animation: pulse2 2s linear infinite;
            opacity: 1;
        }

        @keyframes

        "pulse2" {
            0%;

        {
            -webkit-transform: scale(1.1);
            -moz-transform: scale(1.1);
            -o-transform: scale(1.1);
            -ms-transform: scale(1.1);
            transform: scale(1.1);
        }

        50% {
            -webkit-transform: scale(0.8);
            -moz-transform: scale(0.8);
            -o-transform: scale(0.8);
            -ms-transform: scale(0.8);
            transform: scale(0.8);
        }

        100% {
            -webkit-transform: scale(1);
            -moz-transform: scale(1);
            -o-transform: scale(1);
            -ms-transform: scale(1);
            transform: scale(1);
        }

        }

        @-moz-keyframes pulse2 {
            0% {
                -moz-transform: scale(1.1);
                transform: scale(1.1);
            }

            50% {
                -moz-transform: scale(0.8);
                transform: scale(0.8);
            }

            100% {
                -moz-transform: scale(1);
                transform: scale(1);
            }
        }

        @-webkit-keyframes

        "pulse2" {
            0%;

        {
            -webkit-transform: scale(1.1);
            transform: scale(1.1);
        }

        50% {
            -webkit-transform: scale(0.8);
            transform: scale(0.8);
        }

        100% {
            -webkit-transform: scale(1);
            transform: scale(1);
        }

        }

        @-ms-keyframes

        "pulse2" {
            0%;

        {
            -ms-transform: scale(1.1);
            transform: scale(1.1);
        }

        50% {
            -ms-transform: scale(0.8);
            transform: scale(0.8);
        }

        100% {
            -ms-transform: scale(1);
            transform: scale(1);
        }

        }

        input.buttoninf {
            background-color: #d3d3d3;
            -webkit-animation-name: grayPulse;
            -webkit-animation-duration: 1s;
            -webkit-animation-iteration-count: infinite;
            -webkit-box-shadow: 0 0 18px #d3d3d3;
        }

        div.timer {
            border: 1px #666666 solid;
            width: 190px;
            height: 50px;
            line-height: 50px;
            font-size: 36px;
            font-family: "Courier New", Courier, monospace;
            text-align: center;
            margin: auto;
            margin-top: 20px;
        }

        #tempo {
            opacity: 0;
        }
    </style>

    <meta charset="utf-8" />
    <title>Teste de Alcoolemia</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="speedometer.js"></script>
    <script>


			function changeclass () {
				var ran = Math.floor((Math.random() * 16) + 3);
				var rans = ran.toString();
				var txtfinal = "Cancelar (" + rans + "s)";
				if(document.getElementById("butaotaxi").value == "Chamar Taxi"){
					$(taxi).toggleClass('pulse2');
					$(butaotaxi).css( "font-size", "-=3" );
					$(butaotaxi).val(txtfinal);
					timer.reset(ran);
					timer.start();
					$(tempo).css("opacity", "+=1");
					$(backToMainMenu).css("margin-top", "+=110");
					document.getElementById('hrefBackToMain').href = "main.html?hid1=" + contador.toString() + "&hid2=" + flagWaiter.toString() + "&hid3=1" + "&hid4=" + bebidas;
				}
				else{
					$(taxi).toggleClass('tax');
					$(butaotaxi).css( "font-size", "+=3" );
					$(butaotaxi).val("Chamar Taxi");
					timer.stop();
					$(tempo).css("opacity", "-=1");
					$(backToMainMenu).css("margin-top", "-=110");
					document.getElementById('hrefBackToMain').href = "main.html?hid1=" + contador.toString() + "&hid2=" + flagWaiter.toString() + "&hid3=0" + "&hid4=" + bebidas;
				}
			};

			function _timer(callback)
			{
				var time = 0;     //  The default time of the timer
				var mode = 1;     //    Mode: count up or count down
				var status = 0;    //    Status: timer is running or stoped
				var timer_id;    //    This is used by setInterval function

				// this will start the timer ex. start the timer with 1 second interval timer.start(1000)
				this.start = function(interval)
				{
					interval = (typeof(interval) !== 'undefined') ? interval : 1000;

					if(status == 0)
					{
						status = 1;
						timer_id = setInterval(function()
						{
							switch(mode)
							{
								default:
								if(time)
								{
									time--;
									generateTime();
									if(typeof(callback) === 'function') callback(time);
								}
								break;

								case 1:
								if(time < 86400)
								{
									time++;
									generateTime();
									if(typeof(callback) === 'function') callback(time);
								}
								break;
							}
						}, interval);
					}
				}

				//  Same as the name, this will stop or pause the timer ex. timer.stop()
				this.stop =  function()
				{
					if(status == 1)
					{
						status = 0;
						clearInterval(timer_id);
					}
				}

				// Reset the timer to zero or reset it to your own custom time ex. reset to zero second timer.reset(0)
				this.reset =  function(sec)
				{
					sec = (typeof(sec) !== 'undefined') ? sec : 0;
					time = sec;
					generateTime(time);
				}

				// Change the mode of the timer, count-up (1) or countdown (0)
				this.mode = function(tmode)
				{
					mode = tmode;
				}

				// This methode return the current value of the timer
				this.getTime = function()
				{
					return time;
				}

				// This methode return the current mode of the timer count-up (1) or countdown (0)
				this.getMode = function()
				{
					return mode;
				}

				// This methode return the status of the timer running (1) or stoped (1)
				this.getStatus
				{
					return status;
				}

				// This methode will render the time variable to hour:minute:second format
				function generateTime()
				{
					var second = time % 60;
					var minute = Math.floor(time / 60) % 60;
					var hour = Math.floor(time / 3600) % 60;

					second = (second < 10) ? '0'+second : second;
					minute = (minute < 10) ? '0'+minute : minute;
					hour = (hour < 10) ? '0'+hour : hour;

					$('div.timer span.second').html(second);
					$('div.timer span.minute').html(minute);
					$('div.timer span.hour').html(hour);
				}
			}

			// example use
			var timer;

			$(document).ready(function(e)
			{
				timer = new _timer
				(
					function(time)
					{
						if(time == 0)
						{
							timer.stop();
							document.getElementById("myDialog2").showModal();
						}
					}
				);
				timer.reset(0);
				timer.mode(0);
			});

    </script>


    <h1>Teste de Alcoolemia</h1>
</head>
<body onload='draw(0);'>
    <canvas id="tutorial" width="440" height="220">
        Canvas not available.
    </canvas>
    <div align="center"><input type="text" align="center" id="textInput" value="" size="2" readonly><b>g/L</b><br /><br /></div>
    <div id="textbutt" align="center">
        <input type="button" class="button" id="butao" value="Iniciar" onclick="drawWithInputValue()">
        <input type="button" id="butaotaxi" class="button" value="Chamar Taxi" onclick="changeclass()">
        <br />
    </div>
    <div id="buttonINFi" align="center">
        <dialog id="myDialog"><b>Sua taxa de alcoolemia é superior ao permitido por lei para conduzir.</br>Vá de boleia ou chame um taxi!</br></b>(Esc para sair)</dialog>
    </div>
    <div id="buttonINFi2" align="center">
        <dialog id="myDialog2"><b>O seu taxi chegou!</br></b>(Esc para sair)</dialog>
    </div>
    <div id="tempo" class="timer" align="center">
        <span class="minute">00</span>:<span class="second">00</span>
        <img id="taxi" class="tax" src="Images/taxi.jpg" height="100" width="100" align="center">
    </div>
    <div id="backToMainMenu" align="center">
    </div>
</body>


<script>

    var query = window.location.search.substring(1);
    var vars = query.split("&");
    var pair1 = vars[0].split("=");
    contador = pair1[1];
    var pair2 = vars[1].split("=");
    flagWaiter = pair2[1];
    var pair3 = vars[2].split("=");
    taxivalor = pair3[1];
    var pair4 = vars[3].split("=");
    bebidas = pair4[1];
   
    var addressElement1 = document.createElement('a');
    var attribute1 = document.createAttribute("id");
    attribute1.value = "hrefBackToMain";
    addressElement1.setAttributeNode(attribute1);
    var attribute11 = document.createAttribute("class");
    attribute11.value = "image";
    addressElement1.setAttributeNode(attribute11);
    var attribute2 = document.createAttribute("href");
    var address = "main.html?hid1=" + contador.toString() + "&hid2=" + flagWaiter.toString() + "&hid3=" + taxivalor.toString() + "&hid4=" + bebidas;
    attribute2.value = address;
    addressElement1.setAttributeNode(attribute2);
    addressElement1.innerHTML = "<img id=\"Back\" src = \"Images/backicon.png\" width=\"100\" height=\"75\">";
    document.getElementById('backToMainMenu').appendChild(addressElement1);



</script>
</html>
